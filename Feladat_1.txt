> set.seed(101); x=0.2*qgamma(runif(100),1.2)
> hist(x, col="green")
> a=c(0,0.5,1.5,3.5,6,20)
> p/vector()
Error: object 'p' not found
> p=vector()
> for (i in 1:(length(a)-1)) p[i]=pexp(a[i+i])-pexp(a[i])
> p
[1] 0.3934693 0.5763333 0.2231302        NA        NA
> for (i in 1:(length(a)-1)) p[i]=pexp(a[i+1])-pexp(a[i])
> p
[1] 0.39346934 0.38340050 0.19293278 0.02771863 0.00247875
> np=length(x)*p
> np
[1] 39.346934 38.340050 19.293278  2.771863  0.247875
> x.cut=cut(x/mean(x),breaks=a)
> x.cut
  [1] (0,0.5]   (0,0.5]   (0.5,1.5] (0.5,1.5] (0,0.5]   (0,0.5]   (0.5,1.5] (0,0.5]   (0.5,1.5] (0.5,1.5] (1.5,3.5] (0.5,1.5] (0.5,1.5]
 [14] (1.5,3.5] (0.5,1.5] (0.5,1.5] (1.5,3.5] (0,0.5]   (0.5,1.5] (0,0.5]   (0.5,1.5] (1.5,3.5] (0,0.5]   (0.5,1.5] (1.5,3.5] (0.5,1.5]
 [27] (0,0.5]   (0.5,1.5] (0.5,1.5] (0.5,1.5] (0.5,1.5] (0,0.5]   (0,0.5]   (0,0.5]   (0.5,1.5] (1.5,3.5] (0,0.5]   (1.5,3.5] (0,0.5]  
 [40] (1.5,3.5] (0.5,1.5] (0.5,1.5] (0.5,1.5] (0,0.5]   (0.5,1.5] (0,0.5]   (0,0.5]   (1.5,3.5] (0.5,1.5] (0,0.5]   (0,0.5]   (0.5,1.5]
 [53] (0.5,1.5] (0.5,1.5] (0.5,1.5] (0.5,1.5] (0.5,1.5] (0.5,1.5] (0.5,1.5] (0.5,1.5] (1.5,3.5] (1.5,3.5] (0.5,1.5] (3.5,6]   (1.5,3.5]
 [66] (0.5,1.5] (0,0.5]   (0,0.5]   (1.5,3.5] (1.5,3.5] (0,0.5]   (1.5,3.5] (0.5,1.5] (1.5,3.5] (1.5,3.5] (0,0.5]   (0,0.5]   (0,0.5]  
 [79] (0.5,1.5] (1.5,3.5] (0.5,1.5] (0.5,1.5] (0.5,1.5] (3.5,6]   (0,0.5]   (1.5,3.5] (0,0.5]   (0.5,1.5] (0,0.5]   (0,0.5]   (0.5,1.5]
 [92] (1.5,3.5] (0.5,1.5] (0,0.5]   (0,0.5]   (1.5,3.5] (0.5,1.5] (0,0.5]   (0,0.5]   (0,0.5]  
Levels: (0,0.5] (0.5,1.5] (1.5,3.5] (3.5,6] (6,20]
> nu=vector()
> for (i in 1:(length(a)-1)) nu[i]=table(x.cut)[[i]]
> nu
[1] 34 43 21  2  0
> chi2.x=sum((nu-np)^2/np)
> chi2.x
[1] 1.906779
> cat("p=",1-pchisq(chi2.x,length(a)-3),"\n")
p= 0.5919786 
> k=5
> p=seq(from=0, to=1,1/k)
> p
[1] 0.0 0.2 0.4 0.6 0.8 1.0
> a=qexp(p)
> a
[1] 0.0000000 0.2231436 0.5108256 0.9162907 1.6094379       Inf
> np=vector()
> for (i in 1:(length(a)-1)) np[i]=1/k
> np=np*length(x)
> np
[1] 20 20 20 20 20
> x.cut=cut(x/mean(x),breaks=a)
> x.cut
  [1] (0.223,0.511] (0,0.223]     (0.916,1.61]  (0.916,1.61]  (0.223,0.511] (0.223,0.511] (0.511,0.916] (0.223,0.511] (0.916,1.61] 
 [10] (0.511,0.916] (1.61,Inf]    (0.916,1.61]  (0.916,1.61]  (1.61,Inf]    (0.511,0.916] (0.511,0.916] (0.916,1.61]  (0.223,0.511]
 [19] (0.511,0.916] (0,0.223]     (0.916,1.61]  (1.61,Inf]    (0.223,0.511] (0.916,1.61]  (1.61,Inf]    (0.916,1.61]  (0,0.223]    
 [28] (0.511,0.916] (0.511,0.916] (0.916,1.61]  (0.511,0.916] (0.223,0.511] (0.223,0.511] (0,0.223]     (0.511,0.916] (1.61,Inf]   
 [37] (0.223,0.511] (0.916,1.61]  (0,0.223]     (1.61,Inf]    (0.511,0.916] (0.511,0.916] (0.916,1.61]  (0.223,0.511] (0.511,0.916]
 [46] (0.223,0.511] (0,0.223]     (1.61,Inf]    (0.916,1.61]  (0,0.223]     (0,0.223]     (0.511,0.916] (0.916,1.61]  (0.916,1.61] 
 [55] (0.511,0.916] (0.916,1.61]  (0.916,1.61]  (0.511,0.916] (0.916,1.61]  (0.511,0.916] (0.916,1.61]  (0.916,1.61]  (0.916,1.61] 
 [64] (1.61,Inf]    (1.61,Inf]    (0.916,1.61]  (0,0.223]     (0.223,0.511] (1.61,Inf]    (1.61,Inf]    (0.223,0.511] (1.61,Inf]   
 [73] (0.511,0.916] (1.61,Inf]    (0.916,1.61]  (0.223,0.511] (0,0.223]     (0.223,0.511] (0.916,1.61]  (1.61,Inf]    (0.916,1.61] 
 [82] (0.916,1.61]  (0.916,1.61]  (1.61,Inf]    (0,0.223]     (1.61,Inf]    (0.223,0.511] (0.511,0.916] (0,0.223]     (0,0.223]    
 [91] (0.916,1.61]  (1.61,Inf]    (0.916,1.61]  (0.223,0.511] (0.223,0.511] (1.61,Inf]    (0.223,0.511] (0.223,0.511] (0,0.223]    
[100] (0,0.223]    
Levels: (0,0.223] (0.223,0.511] (0.511,0.916] (0.916,1.61] (1.61,Inf]
> nu=vector()
> for (i in 1:(length(a)-1)) nu[i]=table(x.cut)[[i]]
> nu
[1] 15 20 18 29 18
> chi2.x=sum((nu-np)^2/np)
> chi2.x
[1] 5.7
> cat("p=", 1-pchisq(chi2.x,length(a)-3),"\n")
p= 0.1271539 
> 
